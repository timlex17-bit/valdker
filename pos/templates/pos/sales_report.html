{% extends 'admin/base_site.html' %}
{% block content %}

<!-- CDN Data Tabela -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

<h1>Sales Report</h1>

<!-- FILTER + BUTAUN -->
<div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; margin-bottom: 25px; gap: 20px;">

  <!-- FILTER KIRI -->
  <form method="get" style="display: flex; align-items: center; gap: 10px;">
    <label for="month" style="margin: 0;">Filter by Month:</label>
    <input type="month" id="month" name="month" value="{{ request.GET.month }}">
    <button type="submit" class="btn btn-secondary">Filter</button>
  </form>

  <!-- BUTAUN EXPORT LIMAN LOS -->
  <div style="display: flex; gap: 10px;">
    <a href="{% url 'sales_report_pdf' %}?month={{ request.GET.month }}" target="_blank" class="btn btn-danger">üßæ Imprime PDF</a>
    <a href="{% url 'sales_report_excel' %}?month={{ request.GET.month }}" target="_blank" class="btn btn-success">üìä Imprime Excel</a>
    <a href="{% url 'sales_report_print' %}?month={{ request.GET.month }}" target="_blank" class="btn btn-info">üñ®Ô∏è Previzaun Imprime</a>
  </div>
</div>

<!-- TABELA -->
<table id="salesTable" style="width: 100%; border-collapse: collapse;">
  <thead>
    <tr style="background-color: #f2f2f2;">
      <th>Naran Produtu</th>
      <th>ID Invoice</th>
      <th>Quantidade</th>
      <th>Weight</th>
      <th>Presu Total</th>
      <th>Data Order</th>
    </tr>
  </thead>
  <tbody>
    {% for row in rows %}
    <tr>
      <td>{{ row.product_name }}</td>
      <td>{{ row.invoice_id }}</td>
      <td>{{ row.qty }}</td>
      <td>{{ row.weight }}</td>
      <td>${{ row.total_price }}</td>
      <td>{{ row.order_date }}</td>
    </tr>
    {% empty %}
    <tr><td colspan="6" style="text-align:center;">No data found.</td></tr>
    {% endfor %}
  </tbody>
</table>

<!-- Aktiva Tabela Data -->
<script>
  $(document).ready(function () {
    $('#salesTable').DataTable({
      pageLength: 10,
      lengthMenu: [5, 10, 20, 50],
      ordering: true
    });
  });
</script>

{% endblock %}
