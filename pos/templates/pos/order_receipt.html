<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Receipt</title>
    <style>
        body {
            font-family: "Courier New", Courier, monospace;
            font-size: 12px;
            margin: 0;
            padding: 10px;
        }
        .center { text-align: center; }
        .bold { font-weight: bold; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        td { padding: 4px 0; }
        .total {
            margin-top: 10px;
            font-size: 14px;
            font-weight: bold;
        }
        .small { font-size: 10px; }
        img.logo {
            width: 100px;
            height: auto;
            margin-bottom: 5px;
        }
        hr {
            border: none;
            border-top: 1px dashed #000;
            margin: 10px 0;
        }
        .order-type {
            font-size: 10px;
            font-style: italic;
        }
    </style>
</head>
<body>

<div class="center">
    {% if shop.logo %}
        <img src="{{ shop.logo.url }}" alt="Shop Logo" class="logo">
    {% endif %}

    <div class="bold">{{ shop.name }}</div>
    <div class="small">{{ shop.address }}</div>
    <div class="small">{{ shop.phone }}</div>
    <hr>

    <div><b>Invoice:</b> INV{{ order.id|stringformat:"015d" }}</div>
    <div><b>Date:</b> {{ order.created_at|date:"d-m-Y H:i" }}</div>
    <div><b>Cashier:</b> {{ order.served_by.username }}</div>

    <!-- ‚úÖ HEADER ORDER TYPE -->
    <div>
        <b>Order Type:</b>
        {{ order.default_order_type }}
    </div>

    {% if order.table_number %}
        <div><b>Table:</b> {{ order.table_number }}</div>
    {% endif %}

    {% if order.delivery_address %}
        <div><b>Delivery:</b> {{ order.delivery_address }}</div>
    {% endif %}
</div>

<hr>

<table>
    {% for item in order.items.all %}
    <tr>
        <td colspan="2">
            {{ item.product.name }}
        </td>
    </tr>

    <!-- ‚úÖ ORDER TYPE PER ITEM -->
    <tr>
        <td colspan="2" class="order-type">
            {% if item.order_type == "DINE_IN" %}
                (üçΩÔ∏è DINE IN)
            {% elif item.order_type == "DELIVERY" %}
                (üöö DELIVERY)
            {% else %}
                (ü•° TAKE OUT)
            {% endif %}
        </td>
    </tr>

    <tr>
        <td class="small">
            {{ item.quantity }} x ${{ item.price|floatformat:2 }}
        </td>
        <td class="small" style="text-align: right;">
            {% widthratio item.price 1 item.quantity as line_total %}
            ${{ line_total|floatformat:2 }}
        </td>
    </tr>
    {% endfor %}
</table>

<hr>

<div class="total">
    Subtotal: ${{ order.subtotal|floatformat:2 }}<br>
    Discount: ${{ order.discount|floatformat:2 }}<br>
    Tax: ${{ order.tax|floatformat:2 }}<br>
    Total: ${{ order.total|floatformat:2 }}
</div>

<hr>

<div class="center small">
    Obrigado Barak! üëã<br>
    {{ shop.name }}
</div>

</body>
</html>
